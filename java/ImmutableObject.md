# 불변객체

**updated 2023.03.03**

<hr/>

## 불변 객체란?

객체 지향 및 함수형 프로그래밍 에서 불변 객체는 생성된 후 상태를 수정할 수 없는 객체 입니다. 생성 후 수정할 수 있는 가변 객체 (changeable object) 와는 대조적입니다.

문자열 및 기타 구체적인 객체는 일반적으로 객체 지향 프로그래밍 에서 가독성과 런타임 효율성을 개선하기 위해 불변 객체로 표현됩니다. 불변 객체는 본질적으로 스레드로부터 안전 하기 때문에 유용합니다. 다른 이점은 변경 가능한 개체보다 이해하고 추론하기 쉽고 더 높은 보안을 제공한다는 것입니다.

참고 [불변객체](https://ko.wikipedia.org/wiki/%EB%B6%88%EB%B3%80%EA%B0%9D%EC%B2%B4)

파악한 특징

- 초기화 후에 변경되지 않는다.
- 가독성과 런타임 효율성을 위해 사용?
- 스레드로 부터 안전 (Thread-safe)?

> 생성 후 상태를 바꿀 수 없는 객체란 힙영역에서 그 객체가 가리키고 있는 데이터 자체의 변화가 불가능하다는 것을 의미합니다. (...중략)
> 자바에서 Reference를 가지고 있는 타입은 실제 데이터는 힙 영역에 저장하고 그 힙 영역을 가리키는 주소 값을 Stack 영역에서 가지고 있습니다.
> [참고 : 불변객체란?](https://velog.io/@kyle/%EB%B6%88%EB%B3%80-%EA%B0%9D%EC%B2%B4%EB%9E%80-Java-Immutable-Object)

## 불변 객체를 생성하는 방법

> 1. setter 메소드를 사용하지 마라
> 2. 모든 필드를 final 과 private를 사용해서 선언해라
> 3. 클래스를 final 로 선언하여 Overriding을 막아라
> 4. 객체를 생성하기 위한 생성자 혹은 정적 팩토리 메소드를 추가해라
> 5. 인스턴스 필드에 가변객체가 포함된다면 방어적 복사를 이용하여 전달해라

참고 : [불변 객체를 사용해야하는 이유](https://dev-cool.tistory.com/23)

## 불변 객체의 장점

> - Thread-Safe하여 병렬 프로그래밍에 유용하고 동기화를 고려하지 않아도 된다.
>   멀티 스레드 환경에서 발생하는 주된 문제는 공유자원에 대해 서로 변경하다보니 값이 덮어씌워지는 문제가 있습니다.
>   하지만 불변객체는 항상 동일한 값을 보장하므로 동기화를 신경쓸 필요가 없다는 장점이 있습니다.

> - 내부 상태의 변경이 없기 때문에 Cache, Map, Set 등의 요소로 활용하기에 적합하다.
>   Cache, Map, Set 의 요소가 변경되었다면 이를 갱신하는 작업이 필요하지만, 불변객체의 경우 데이터를 저장 후 이후 부가작업을 고려하지 않아도 되어 용이합니다.

> - 외부에서 객체에 대해 변경할 수 없기 때문에 안정성이 있다.
>   가변객체에 객체의 값을 set할 수 있는 메소드가 열려있다면 이 객체의 값이 무엇인지 파악하기 어렵고 어떤 값이 들어가 있을지 파악하기 쉽지 않습니다.
>   하지만 불변객체는 값의 수정이 불가능해 객체의 상태가 변경되지 않아 객체의 신뢰성이 높습니다.

> - 가비지 컬렉션의 성능을 높일 수 있다.
>   불변객체는 기본적으로 값의 변경이 불가합니다. 상태의 변경이 필요한 경우 새로운 객체를 생성해서 사용해야 합니다.
>   새로운 객체가 많이 생성될 경우 성능상 좋지 않을거라 생각하는 의견이 많이 있습니다. 저 역시도 이와 비슷한 의문을 가지고 있습니다.

참고 : [불변 객체에 대해 알아보자](https://devoong2.tistory.com/entry/Java-%EB%B6%88%EB%B3%80-%EA%B0%9D%EC%B2%B4Immutable-Object-%EC%97%90-%EB%8C%80%ED%95%B4-%EC%95%8C%EC%95%84%EB%B3%B4%EC%9E%90)

- Cache, Map, Set 등의 요소로 활용하기에 적합하다 란 부분이 아직 잘 이해가 되지 않는다. Map, Set 자료구조에 대한 이해가 부족해서 그런것 같다. 더 알아볼 것.
